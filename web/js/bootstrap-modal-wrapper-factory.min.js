!function(o,t){"use strict";"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery"),require("bootstrap")):"function"==typeof define&&define.amd?define("bootstrap-modal-wrapper-factory",["jquery","bootstrap"],function(o){return t(o)}):o.BootstrapModalWrapperFactory=t(o.jQuery)}(this,function(o){"use strict";var t={};function a(a){this.options=o.extend({},t,a),this.defaults=t,this.globalModals=[],this.registerGlobalEventsHandler()}a.prototype.createModal=function(o){var t=new l(this,o);return this.globalModals.push(t),t.init(),t},a.prototype.createAjaxModal=function(t){var a=this.createModal(t),i=o.extend(!0,a.options,{url:null,dataType:"html",httpMethod:"GET",passData:{},sendId:!0,idParameter:"ajaxModalId",updateSizeAfterDataFetchTo:"modal-lg",ajaxContainerReadyEventName:"ajax-container-ready"},t);return i.sendId&&(i.passData[i.idParameter]=a.options.id),a.originalModal.removeClass("fade"),a.originalModal.find(".modal-dialog").css({transition:"all .3s"}),a.originalModal.find(".modal-body").css({"max-height":"65vh","overflow-y":"auto","overflow-x":"hidden"}),a.originalModal.css({overflow:"hidden"}),a.originalModal.one("shown.bs.modal",function(t){o.ajax({type:i.httpMethod,dataType:i.dataType,url:i.url,data:i.passData,success:function(t,n,e){a.updateSize(i.updateSizeAfterDataFetchTo),a.updateMessage(t),setTimeout(function(){o("#"+a.options.id).trigger(i.ajaxContainerReadyEventName,[a])},0)}})}),a.show(),a};var i="<div class='modal-header'></div>",n="<h5 class='modal-title'></h5>",e="                <button type='button' class='close' data-dismiss='modal' aria-label='Close'>                    <span aria-hidden='true'>&times;</span>                </button>",s="<div class='modal-footer d-flex flex-wrap p-2 border-0' style='margin-top:-15px;'></div>",d=function(o){return o+"-"+Math.floor(1e8*Math.random()+1)+"-"+(new Date).getTime()+"-"+function(){var o,t,a="";for(o=0;o<32;o++)t=16*Math.random()|0,8!==o&&12!==o&&16!==o&&20!==o||(a+="-"),a+=(12===o?4:16===o?3&t|8:t).toString(16);return a}()};function l(t,a){this.factory=t,this.options=o.extend({},{id:d("b-m-w"),title:null,message:null,closable:!1,closeByBackdrop:!0,closeByKeyboard:!0,size:null,onDestroy:null,buttons:[],headerClass:null,localData:{},centered:!1},a),o.extend(!0,this.options.localData,a.localData),this.originalModal=null,this.isDestroy=!1,this.isOpen=!1}return l.prototype.generateTemplate=function(){this.originalModal=o("<div class='modal fade' id='' tabindex='-1' role='dialog' aria-labelledby='' aria-hidden='true'>    <div class='modal-dialog modal-dialog-centered' role='document'>        <div class='modal-content' style='font-size:16px;'>        </div>    </div></div>"),this.originalModal.attr("id",this.options.id);var t=this.originalModal.find(".modal-dialog");if(!this.options.size||"modal-sm"!==this.options.size&&"modal-lg"!==this.options.size||t.addClass(""),!0===this.options.centered&&t.addClass("modal-dialog-centered"),(this.options.title||this.options.closable)&&this.originalModal.find(".modal-content").append(i),this.options.title&&this.originalModal.find(".modal-header").append(n).find(".modal-title").append(this.options.title),this.options.closable&&this.originalModal.find(".modal-header").append(e),this.options.headerClass&&this.originalModal.find(".modal-header").addClass(this.options.headerClass),this.options.message&&(this.originalModal.find(".modal-content").append("<div class='modal-body'></div>"),this.originalModal.find(".modal-body").html("").append(this.options.message)),this.options.buttons&&0<this.options.buttons.length){this.originalModal.find(".modal-content").append(s);for(var a=0;a<this.options.buttons.length;a++){var d=this.options.buttons[a];this.addButton(d,!1)}}},l.prototype.init=function(){this.generateTemplate();var t=this;this.originalModal.on("show.bs.modal",function(t){t.stopPropagation();var a=1e5+10*o(".modal.show").length;o(this).css("z-index",a),setTimeout(function(){o(".modal-backdrop").not(".modal-stack").first().css("z-index",a-1).addClass("modal-stack")},0)}).on("shown.bs.modal",function(o){o.stopPropagation(),t.isOpen=!0}).on("hide.bs.modal",function(o){o.stopPropagation(),t.options.onDestroy&&"function"==typeof t.options.onDestroy&&(t.options.onDestroy.call(t,t)||o.preventDefault())}).on("hidden.bs.modal",function(a){a.stopPropagation(),t.destroy(),o(".modal.show").length&&o("body").addClass("modal-open")})},l.prototype.destroy=function(){var t=this;this.originalModal.modal("hide").promise().done(function(){t.isOpen=!1,o("#"+t.options.id).off("show.bs.modal"),o("#"+t.options.id).off("hidden.bs.modal"),o("#"+t.options.id).modal("dispose");for(var a=0;a<t.options.buttons.length;a++)t.options.buttons[a].buttonObject.off();for(t.isDestroy=!0,a=t.factory.globalModals.length;a--;)if(t.factory.globalModals[a].options.id===t.options.id){t.factory.globalModals.splice(a,1);break}o("#"+t.options.id).find(".modal-dialog").off(),o("#"+t.options.id).off(),o("#"+t.options.id).remove()})},l.prototype.show=function(){var o={show:!0,backdrop:!!this.options.closeByBackdrop||"static",keyboard:this.options.closeByKeyboard,focus:!0};return this.originalModal.modal(o),this},l.prototype.hide=function(){this.originalModal.modal("hide")},l.prototype.updateTitle=function(o){this.options.title=o;var t=this.originalModal.find(".modal-title");if(0===t.length){var a=this.originalModal.find(".modal-header");0===a.length&&(this.originalModal.find(".modal-content").prepend(i),a=this.originalModal.find(".modal-header")),a.prepend(n),t=this.originalModal.find(".modal-title")}return t.html(o),this.originalModal.modal("handleUpdate"),this},l.prototype.updateClosable=function(o){if(this.options.closable!==o){if(this.options.closable=o,!0===this.options.closable){var t=this.originalModal.find(".modal-header");0===t.length&&(this.originalModal.find(".modal-content").prepend(i),t=this.originalModal.find(".modal-header")),t.append(e)}else if(!1===this.options.closable){var a=this.originalModal.find(".modal-header").find("button.close");a.off(),a.remove(),0===this.originalModal.find(".modal-header").find(".modal-title").length&&this.originalModal.find(".modal-header").remove()}this.originalModal.modal("handleUpdate")}return this},l.prototype.updateClosableByBackdrop=function(t){return this.options.closeByBackdrop!==t&&(this.options.closeByBackdrop=t,o("#"+this.options.id).data("bs.modal")._config.backdrop=!!this.options.closeByBackdrop||"static",this.originalModal.modal("handleUpdate")),this},l.prototype.removeHeader=function(){var o=this.originalModal.find(".modal-header");if(0<o.length){var t=o.find("button.close");0<t.length&&(t.off(),t.remove(),this.options.closable=!1),o.remove(),this.options.title=null}return this.originalModal.modal("handleUpdate"),this},l.prototype.updateMessage=function(o){return this.options.message=o,this.originalModal.find(".modal-body").html("").html(o),this.originalModal.modal("handleUpdate"),this},l.prototype.updateSize=function(o){return this.options.size!==o&&(this.options.size=o,this.options.size&&void 0!==this.options.size&&null!==this.options.size?"modal-sm"!==this.options.size&&"modal-lg"!==this.options.size||(this.originalModal.find(".modal-dialog").removeClass("modal-lg modal-sm"),this.originalModal.find(".modal-dialog").addClass(this.options.size)):this.originalModal.find(".modal-dialog").removeClass("modal-lg modal-sm"),this.originalModal.modal("handleUpdate")),this},l.prototype.addButton=function(t,a){var i=this.originalModal.find(".modal-footer");0===i.length&&(this.originalModal.find(".modal-content").append(s),i=this.originalModal.find(".modal-footer")),t.id=t.id?t.id:d("modal-button");var n=o("<button id='' type='button' class='my-1'></button>");return n.attr("id",t.id),n.addClass(t.cssClass?t.cssClass:""),n.append(t.label),(t.buttonObject=n).on("click",{modalWrapper:this,button:n,buttonData:t},function(o){var t=o.data.modalWrapper,a=o.data.button,i=o.data.buttonData;if(i.action&&"function"==typeof i.action)return i.action.call(a,t,a,i,o)}),!1!==a&&this.options.buttons.push(t),n.appendTo(i)},l.prototype.setOnDestroy=function(o){this.options.onDestroy=o},l.prototype.removeButton=function(o){for(var t=null,a=this.options.buttons.length;a--;)this.options.buttons[a].id===o&&((t=this.options.buttons[a]).buttonObject.off(),t.buttonObject.remove(),this.options.buttons.splice(a,1));return this},a.prototype.showMessage=function(a){var i;return i="object"==typeof a&&a.constructor==={}.constructor?o.extend(!0,t,a):o.extend(!0,t,{message:a}),this.createModal(i).show()},a.prototype.alert=function(t){var a,i={title:"",message:"",closable:!0,closeByBackdrop:!0,closeByKeyboard:!0,buttons:[{label:"OK",cssClass:"btn btn-sm btn-primary",action:function(o,t,a,i){o.hide()}}],headerClass:"d-none"};return a="object"==typeof t&&t.constructor==={}.constructor?o.extend(!0,i,t):o.extend(!0,i,{message:t}),this.createModal(a).show()},a.prototype.confirm=function(t){var a={title:"",message:"",closable:!1,closeByBackdrop:!1,closeByKeyboard:!1,buttons:[{label:"No",cssClass:"btn btn-sm btn-secondary",action:function(o,a,i,n){o.hide(),t.onConfirmCancel&&"function"==typeof t.onConfirmCancel&&t.onConfirmCancel()}},{label:"Yes",cssClass:"btn btn-sm btn-primary",action:function(o,a,i,n){o.hide(),t.onConfirmAccept&&"function"==typeof t.onConfirmAccept&&t.onConfirmAccept()}}],headerClass:"d-none"},i=o.extend({},a,t);return this.createModal(i).show()},a.prototype.registerGlobalEventsHandler=function(){o(document).on("show.bs.modal",".modal",function(t){var a=1e5+10*o(".modal.show").length;o(this).css("z-index",a),setTimeout(function(){o(".modal-backdrop").not(".modal-stack").first().css("z-index",a-1).addClass("modal-stack")},0)}).on("hidden.bs.modal",".modal",function(t){o(".modal.show").length&&o("body").addClass("modal-open")}),o(document).on("inserted.bs.tooltip",function(t){var a=1e5+10*o(".modal.show").length,i=o(t.target).attr("aria-describedby");o("#"+i).css("z-index",a)}),o(document).on("inserted.bs.popover",function(t){var a=1e5+10*o(".modal.show").length,i=o(t.target).attr("aria-describedby");o("#"+i).css("z-index",a)})},new a});